<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Áà±Â∞îÂÖ∞Ë∑ØËÄÉËã±ËØ≠Â≠¶‰π†Á≥ªÁªü</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #5a67d8;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #718096;
            font-size: 1.1em;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 15px 30px;
            background: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .mode-btn.active {
            background: #5a67d8;
            color: white;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            margin-bottom: 20px;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: #cbd5e0 #f7fafc;
        }

        .category-tabs::-webkit-scrollbar {
            height: 6px;
        }

        .category-tabs::-webkit-scrollbar-track {
            background: #f7fafc;
            border-radius: 3px;
        }

        .category-tabs::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
        }

        .category-tab {
            flex-shrink: 0;
            padding: 12px 24px;
            background: #f7fafc;
            border: 2px solid transparent;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            color: #4a5568;
        }

        .category-tab:hover {
            background: #e2e8f0;
            transform: translateY(-2px);
        }

        .category-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .category-tab-icon {
            font-size: 1.3em;
        }

        .category-tab-title {
            font-size: 1em;
        }

        .category-tab-count {
            font-size: 0.85em;
            opacity: 0.8;
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 8px;
            border-radius: 12px;
            margin-left: 4px;
        }

        .command-list {
            display: none;
        }

        .command-list.active {
            display: block;
        }

        .command-item {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            position: relative;
            transition: all 0.3s ease;
        }

        .command-item:hover {
            background: #edf2f7;
            transform: translateX(5px);
        }

        .command-type {
            display: inline-block;
            padding: 5px 15px;
            background: #5a67d8;
            color: white;
            border-radius: 20px;
            font-size: 0.8em;
            margin-bottom: 10px;
        }

        .command-english {
            font-size: 1.1em;
            font-weight: 500;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .command-chinese {
            color: #718096;
            line-height: 1.6;
        }

        .audio-controls {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 10px;
        }

        .audio-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #5a67d8;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .audio-btn:hover {
            background: #4c51bf;
            transform: scale(1.1);
        }

        .audio-btn.playing {
            background: #48bb78;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(72, 187, 120, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(72, 187, 120, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(72, 187, 120, 0);
            }
        }

        .quiz-area {
            display: none;
            text-align: center;
        }

        .quiz-question {
            font-size: 1.5em;
            margin-bottom: 30px;
            color: #2d3748;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .quiz-option {
            padding: 20px;
            background: #f7fafc;
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: #edf2f7;
            border-color: #5a67d8;
        }

        .quiz-option.correct {
            background: #c6f6d5;
            border-color: #48bb78;
        }

        .quiz-option.incorrect {
            background: #fed7d7;
            border-color: #f56565;
        }

        .quiz-score {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #5a67d8;
        }

        .quiz-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .quiz-btn {
            padding: 12px 30px;
            background: #5a67d8;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-btn:hover {
            background: #4c51bf;
            transform: translateY(-2px);
        }

        .speed-control {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: white;
            border-radius: 50px;
            padding: 10px 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .speed-label {
            font-size: 0.9em;
            color: #718096;
        }

        .speed-select {
            padding: 5px 15px;
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            background: white;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .category-tabs {
                gap: 8px;
                padding: 8px 0;
            }
            
            .category-tab {
                padding: 10px 16px;
                font-size: 0.9em;
            }
            
            .category-tab-icon {
                font-size: 1.1em;
            }
            
            .quiz-options {
                grid-template-columns: 1fr;
            }
            
            .command-item {
                padding-right: 60px;
            }
            
            .audio-controls {
                flex-direction: column;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöó Áà±Â∞îÂÖ∞Ë∑ØËÄÉËã±ËØ≠Â≠¶‰π†Á≥ªÁªü</h1>
            <p class="subtitle">ÊéåÊè°ÂÆòÊñπÂè£‰ª§ÔºåËΩªÊùæÈÄöËøáË∑ØËÄÉ</p>
            <div id="voice-status" style="margin-top: 10px; font-size: 0.9em; color: #718096;"></div>
        </header>

        <div class="mode-selector">
            <button class="mode-btn active" onclick="showMode('learn')">
                üìö Â≠¶‰π†Ê®°Âºè
            </button>
            <button class="mode-btn" onclick="showMode('quiz-cn-en')">
                üéØ ‰∏≠ËØëËã±ÊµãÈ™å
            </button>
            <button class="mode-btn" onclick="showMode('quiz-en-cn')">
                üéØ Ëã±ËØë‰∏≠ÊµãÈ™å
            </button>
        </div>

        <div class="content-area">
            <!-- Â≠¶‰π†Ê®°Âºè -->
            <div id="learn-mode" class="learn-area">
                <div class="category-tabs" id="categoryTabs"></div>
                <div id="commandContent"></div>
            </div>

            <!-- ÊµãÈ™åÊ®°Âºè -->
            <div id="quiz-mode" class="quiz-area">
                <div class="quiz-score" id="quizScore">ÂæóÂàÜ: 0 / 0</div>
                <div class="quiz-question" id="quizQuestion"></div>
                <div class="quiz-options" id="quizOptions"></div>
            </div>
        </div>

        <div class="speed-control">
            <span class="speed-label">ËØ≠ÈÄü:</span>
            <select class="speed-select" id="speechRate" onchange="updateSpeechRate()">
                <option value="0.8">ÊÖ¢ÈÄü</option>
                <option value="1" selected>Ê≠£Â∏∏</option>
                <option value="1.2">Âø´ÈÄü</option>
            </select>
        </div>
    </div>

    <script>
        // Êï∞ÊçÆÁªìÊûÑ
        const categories = [
            {
                id: 'startup',
                icon: 'üîë',
                title: 'ÂêØÂä®',
                commands: [
                    {
                        english: 'Please start up the engine.',
                        chinese: 'ËØ∑ÂêØÂä®ÂºïÊìé„ÄÇ'
                    },
                    {
                        english: 'Now, you should drive in your normal manner. I will tell you in good time when to turn left or right, otherwise you follow the course of the road. If you have any doubts about my directions, ask me to repeat or clarify them. You may start when you are ready.',
                        chinese: 'ÂÆòÊñπÂè£‰ª§ÔºöÁé∞Âú®ËØ∑‰ª•Ê≠£Â∏∏ÊñπÂºèÈ©æÈ©∂„ÄÇÊàë‰ºöÊèêÂâçÂëäËØâ‰Ω†‰ªÄ‰πàÊó∂ÂÄôÂ∑¶ËΩ¨ÊàñÂè≥ËΩ¨ÔºåÂê¶ÂàôËØ∑Ê≤øË∑ØË°åÈ©∂„ÄÇÂ¶ÇÊûúÂØπÊåá‰ª§ÊúâÁñëÈóÆÔºåÂèØ‰ª•ËÆ©ÊàëÈáçÂ§çÊàñËß£Èáä„ÄÇÂáÜÂ§áÂ•ΩÂêéÂ∞±ÂèØ‰ª•Âá∫Âèë„ÄÇ'
                    }
                ]
            },
            {
                id: 'basic',
                icon: 'üõ£Ô∏è',
                title: 'ÈÅìË∑ØÂü∫Êú¨Ë°åÈ©∂',
                commands: [
                    {
                        english: 'At the next junction, turn right.',
                        chinese: 'Âú®‰∏ã‰∏Ä‰∏™Ë∑ØÂè£Âè≥ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'At the traffic light, turn left.',
                        chinese: 'Âú®Á∫¢ÁªøÁÅØÂ§ÑÂ∑¶ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'Take the next road on the right, please.',
                        chinese: 'ËØ∑Âú®‰∏ã‰∏Ä‰∏™Â≤îË∑ØÂè≥ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'At the end of the road, turn left.',
                        chinese: 'Âú®ËøôÊù°Ë∑ØÁöÑÂ∞ΩÂ§¥Â∑¶ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'Take the next right.',
                        chinese: 'Âú®‰∏ã‰∏Ä‰∏™Ë∑ØÂè£Âè≥ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'Take the next left.',
                        chinese: 'Âú®‰∏ã‰∏Ä‰∏™Ë∑ØÂè£Â∑¶ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'Go straight ahead.',
                        chinese: 'Áõ¥Ë°å„ÄÇ'
                    },
                    {
                        english: 'Keep going straight ahead.',
                        chinese: 'ÁªßÁª≠Áõ¥Ë°å„ÄÇ'
                    }
                ]
            },
            {
                id: 'roundabout',
                icon: 'üîÑ',
                title: 'ÁéØÂ≤õË°åÈ©∂',
                commands: [
                    {
                        english: 'At the roundabout, take the first exit.',
                        chinese: 'Âú®ÁéØÂ≤õËµ∞Á¨¨‰∏Ä‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'Take the first exit at the roundabout.',
                        chinese: 'Âú®ÁéØÂ≤õËµ∞Á¨¨‰∏Ä‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'At the roundabout, turn left.',
                        chinese: 'Âú®ÁéØÂ≤õÂ∑¶ËΩ¨„ÄÇ'
                    },
                    {
                        english: 'At the roundabout, take the second exit.',
                        chinese: 'Âú®ÁéØÂ≤õËµ∞Á¨¨‰∫å‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'Take the second exit at the roundabout.',
                        chinese: 'Âú®ÁéØÂ≤õËµ∞Á¨¨‰∫å‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'Go straight ahead at the roundabout.',
                        chinese: 'Âú®ÁéØÂ≤õÁõ¥Ë°å„ÄÇ'
                    },
                    {
                        english: 'At the roundabout, take the third exit.',
                        chinese: 'Âú®ÁéØÂ≤õËµ∞Á¨¨‰∏â‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'At the roundabout, take the third exit on the right.',
                        chinese: 'Âú®ÁéØÂ≤õÁöÑÂè≥‰æßËµ∞Á¨¨‰∏â‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'Take the third exit at the roundabout.',
                        chinese: 'Âú®ÁéØÂ≤õËµ∞Á¨¨‰∏â‰∏™Âá∫Âè£„ÄÇ'
                    },
                    {
                        english: 'At the roundabout, turn right.',
                        chinese: 'Âú®ÁéØÂ≤õÂè≥ËΩ¨„ÄÇ'
                    }
                ]
            },
            {
                id: 'uturn',
                icon: '‚Ü©Ô∏è',
                title: 'ÊéâÂ§¥',
                commands: [
                    {
                        english: 'I would like you to turn your car around on the road to face the opposite way. You may go over and back more than once if necessary. You may start when you are ready.',
                        chinese: 'ÂÆòÊñπÂè£‰ª§ÔºöËØ∑Â∞ÜËΩ¶Âú®ÈÅìË∑Ø‰∏äÊéâÂ§¥Ëá≥Áõ∏ÂèçÊñπÂêë„ÄÇÂ¶ÇÊúâÈúÄË¶ÅÂèØÂâçÂêéÂ§öÊ¨°Ë∞ÉÊï¥„ÄÇÂáÜÂ§áÂ•ΩÂêéÂ∞±ÂºÄÂßã„ÄÇ'
                    },
                    {
                        english: 'Turn around your car and go back to where we came from.',
                        chinese: 'ËØ∑Â∞ÜËΩ¶ÊéâÂ§¥Âπ∂ÂéüË∑ØËøîÂõû„ÄÇ'
                    },
                    {
                        english: "Let's do a turnabout.",
                        chinese: 'Êàë‰ª¨Êù•ÂÅö‰∏™ÊéâÂ§¥ÁªÉ‰π†„ÄÇ'
                    },
                    {
                        english: "Let's do a turnaround.",
                        chinese: 'Êàë‰ª¨Êù•ÂÅö‰∏™ÊéâÂ§¥ÁªÉ‰π†„ÄÇ'
                    },
                    {
                        english: "Let's do a three-point turn.",
                        chinese: 'Êàë‰ª¨Êù•ÂÅö‰∏ÄÊ¨°‰∏âÁÇπÊéâÂ§¥„ÄÇ'
                    }
                ]
            },
            {
                id: 'reverse',
                icon: '‚¨ÖÔ∏è',
                title: 'ÂÄíËΩ¶',
                commands: [
                    {
                        english: 'This road on the left is the one I want you to reverse your vehicle into. Will you drive past it and stop on the left, and I will give you further directions.',
                        chinese: 'ÂÆòÊñπÂè£‰ª§ÔºöÊàëÂ∏åÊúõ‰Ω†ÂÄíËΩ¶ËøõÂÖ•Â∑¶ËæπËøôÊù°Ë∑Ø„ÄÇËØ∑ÂÖàÈ©∂ËøáË∑ØÂè£ÁÑ∂ÂêéÈù†Â∑¶ÂÅúËΩ¶ÔºåÊàë‰ºöÂÜçÁªô‰Ω†ÊåáÁ§∫„ÄÇ'
                    },
                    {
                        english: "Reverse into this road on the left. You should continue reversing, while it is safe to do so, keeping reasonably close to the left. I'll tell you when you have gone back far enough; you may start when you are ready.",
                        chinese: 'ÂÆòÊñπÂè£‰ª§ÔºöËØ∑ÊääËΩ¶ÂÄíËøõÂ∑¶ËæπËøôÊù°Ë∑ØÔºåÂú®ÂÆâÂÖ®ÁöÑÊÉÖÂÜµ‰∏ãÁªßÁª≠ÂÄíËΩ¶ÔºåÂ∞ΩÈáèÈù†ËøëÂ∑¶‰æß„ÄÇÂáÜÂ§áÂ•ΩÂêéÂ∞±ÂºÄÂßãÔºåÂÄíËΩ¶Âà∞‰∫ÜË∂≥Â§üÊó∂ÔºåÊàë‰ºöÂëäËØâ‰Ω†„ÄÇ'
                    },
                    {
                        english: 'Reverse around the corner.',
                        chinese: 'Âú®ËΩ¨ËßíÂ§ÑÂÄíËΩ¶„ÄÇ'
                    },
                    {
                        english: 'Reverse around the corner into the road on the left.',
                        chinese: 'Ê≤øËΩ¨ËßíÂÄíËΩ¶ËøõÂÖ•Â∑¶‰æßÈÅìË∑Ø„ÄÇ'
                    },
                    {
                        english: 'Reverse into the next road on the left.',
                        chinese: 'ÂÄíËΩ¶ËøõÂÖ•‰∏ã‰∏Ä‰∏™Â∑¶ËæπÁöÑË∑ØÂè£„ÄÇ'
                    }
                ]
            },
            {
                id: 'parking',
                icon: 'üÖøÔ∏è',
                title: 'Èù†ËæπÂÅúËΩ¶‰∏éËµ∑Ê≠•',
                commands: [
                    {
                        english: 'Pull up on the left in a safe place.',
                        chinese: 'ËØ∑Âú®ÂÆâÂÖ®ÁöÑ‰ΩçÁΩÆÈù†Â∑¶ÂÅúËΩ¶„ÄÇ'
                    },
                    {
                        english: 'Pull up on the left, please.',
                        chinese: 'ËØ∑Èù†Â∑¶ÂÅúËΩ¶„ÄÇ'
                    },
                    {
                        english: 'Please move off.',
                        chinese: 'ËØ∑Ëµ∑Ê≠•„ÄÇ'
                    },
                    {
                        english: "Move off when it's safe.",
                        chinese: 'ÂÆâÂÖ®Êó∂ËØ∑Ëµ∑Ê≠•„ÄÇ'
                    },
                    {
                        english: 'Drive on when you are ready.',
                        chinese: 'ÂáÜÂ§áÂ•ΩÊó∂ËØ∑Ëµ∑Ê≠•Ë°åÈ©∂„ÄÇ'
                    },
                    {
                        english: "When it's safe, drive on.",
                        chinese: 'ÂÆâÂÖ®Êó∂ËØ∑Ëµ∑Ê≠•Ë°åÈ©∂„ÄÇ'
                    },
                    {
                        english: 'Stop and move off again.',
                        chinese: 'ÂÅú‰∏Ä‰∏ãÁÑ∂ÂêéÂÜçËµ∑Ê≠•ÔºàÊ®°Êãü‰∏¥Êó∂ÂÅúËΩ¶ÂÜçÂºÄÔºâ„ÄÇ'
                    }
                ]
            },
            {
                id: 'finish',
                icon: 'üèÅ',
                title: 'ÁªìÊùüÂâçÂÅúËΩ¶',
                commands: [
                    {
                        english: 'Please find a suitable place and park.',
                        chinese: 'ËØ∑Êâæ‰∏Ä‰∏™ÂêàÈÄÇÁöÑ‰ΩçÁΩÆÂÅúËΩ¶„ÄÇ'
                    }
                ]
            }
        ];

        // ÂÖ®Â±ÄÂèòÈáè
        let currentMode = 'learn';
        let currentCategory = null;
        let quizMode = '';
        let quizQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let totalQuestions = 0;
        let speechRate = 1;
        let wrongAnswers = [];  // Â≠òÂÇ®ÈîôÈ¢ò

        // ÂàùÂßãÂåñ
        function init() {
            renderCategoryTabs();
            // ÈªòËÆ§ÊòæÁ§∫Á¨¨‰∏Ä‰∏™ÂàÜÁ±ª
            selectCategory(categories[0].id);
            
            // ÂàùÂßãÂåñËØ≠Èü≥
            if (window.speechSynthesis) {
                // Âä†ËΩΩËØ≠Èü≥ÂàóË°®
                const loadVoices = () => {
                    const voices = speechSynthesis.getVoices();
                    if (voices.length > 0) {
                        console.log('ÂèØÁî®ËØ≠Èü≥Êï∞Èáè:', voices.length);
                        updateVoiceStatus();
                    }
                };
                
                loadVoices();
                if (speechSynthesis.onvoiceschanged !== undefined) {
                    speechSynthesis.onvoiceschanged = loadVoices;
                }
            }
        }

        // Êõ¥Êñ∞ËØ≠Èü≥Áä∂ÊÄÅÊòæÁ§∫
        function updateVoiceStatus() {
            const statusEl = document.getElementById('voice-status');
            const voices = speechSynthesis.getVoices();
            const englishVoices = voices.filter(v => v.lang.includes('en'));
            const premiumVoices = englishVoices.filter(v => 
                v.name.includes('Google') || 
                v.name.includes('Microsoft') || 
                v.name.includes('Premium') || 
                v.name.includes('Natural')
            );
            
            if (premiumVoices.length > 0) {
                statusEl.textContent = `‚úÖ ‰ΩøÁî®È´òË¥®ÈáèËØ≠Èü≥: ${premiumVoices[0].name}`;
                statusEl.style.color = '#48bb78';
            } else if (englishVoices.length > 0) {
                statusEl.textContent = `üîä ‰ΩøÁî®Á≥ªÁªüËØ≠Èü≥: ${englishVoices[0].name}`;
                statusEl.style.color = '#4299e1';
            } else {
                statusEl.textContent = '‚ö†Ô∏è Êú™Ê£ÄÊµãÂà∞Ëã±ËØ≠ËØ≠Èü≥';
                statusEl.style.color = '#e53e3e';
            }
        }

        // ÊòæÁ§∫ÊµãÈ™åÁªìÊûú
        function showQuizResult() {
            const accuracy = totalQuestions > 0 ? Math.round(score/totalQuestions*100) : 0;
            let resultHTML = `
                <div style="text-align: center; padding: 20px;">
                    <h2 style="color: #5a67d8; margin-bottom: 20px;">ÊµãÈ™åÂÆåÊàêÔºÅ</h2>
                    <div style="font-size: 3em; margin-bottom: 20px;">
                        ${accuracy >= 80 ? 'üéâ' : accuracy >= 60 ? 'üëç' : 'üí™'}
                    </div>
                    <p style="font-size: 1.5em; margin-bottom: 10px;">
                        ÂæóÂàÜ: <strong>${score} / ${totalQuestions}</strong>
                    </p>
                    <p style="font-size: 1.3em; margin-bottom: 30px;">
                        Ê≠£Á°ÆÁéá: <strong>${accuracy}%</strong>
                    </p>
            `;
            
            if (wrongAnswers.length > 0) {
                resultHTML += `
                    <div style="margin-bottom: 20px;">
                        <button class="quiz-btn" onclick="showWrongAnswers()">Êü•ÁúãÈîôÈ¢ò (${wrongAnswers.length})</button>
                    </div>
                `;
            }
            
            resultHTML += `
                    <div>
                        <button class="quiz-btn" onclick="resetQuiz()">ÈáçÊñ∞ÂºÄÂßã</button>
                        <button class="quiz-btn" onclick="showMode('learn')">ËøîÂõûÂ≠¶‰π†</button>
                    </div>
                </div>
            `;
            
            document.getElementById('quizQuestion').innerHTML = resultHTML;
            document.getElementById('quizOptions').innerHTML = '';
        }
        
        // ÊòæÁ§∫ÈîôÈ¢òÂõûÈ°æ
        function showWrongAnswers() {
            let wrongAnswersHTML = `
                <div style="text-align: left;">
                    <h2 style="color: #5a67d8; margin-bottom: 20px; text-align: center;">ÈîôÈ¢òÂõûÈ°æ</h2>
            `;
            
            wrongAnswers.forEach((item, index) => {
                const isChineseToEnglish = item.mode === 'quiz-cn-en';
                wrongAnswersHTML += `
                    <div style="background: #f7fafc; padding: 20px; margin-bottom: 15px; border-radius: 10px; border-left: 4px solid #e53e3e;">
                        <div style="font-weight: bold; margin-bottom: 10px; color: #2d3748;">
                            ${index + 1}. ${isChineseToEnglish ? '‰∏≠ËØëËã±' : 'Ëã±ËØë‰∏≠'}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>È¢òÁõÆÔºö</strong>${isChineseToEnglish ? item.question.chinese : item.question.english}
                        </div>
                        <div style="margin-bottom: 10px; color: #e53e3e;">
                            <strong>‰Ω†ÁöÑÁ≠îÊ°àÔºö</strong>${item.userAnswer} ‚ùå
                        </div>
                        <div style="color: #48bb78;">
                            <strong>Ê≠£Á°ÆÁ≠îÊ°àÔºö</strong><br>
                            ${item.correctAnswers.map(ans => `‚Ä¢ ${ans}`).join('<br>')}
                        </div>
                    </div>
                `;
            });
            
            wrongAnswersHTML += `
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="quiz-btn" onclick="showQuizResult()">ËøîÂõûÁªìÊûú</button>
                        <button class="quiz-btn" onclick="resetQuiz()">ÈáçÊñ∞ÂºÄÂßã</button>
                    </div>
                </div>
            `;
            
            document.getElementById('quizQuestion').innerHTML = wrongAnswersHTML;
            document.getElementById('quizOptions').innerHTML = '';
        }

        // Ê∏≤ÊüìÂàÜÁ±ªÊ†áÁ≠æ
        function renderCategoryTabs() {
            const tabsContainer = document.getElementById('categoryTabs');
            tabsContainer.innerHTML = categories.map(cat => `
                <div class="category-tab" id="tab-${cat.id}" onclick="selectCategory('${cat.id}')">
                    <span class="category-tab-icon">${cat.icon}</span>
                    <span class="category-tab-title">${cat.title}</span>
                    <span class="category-tab-count">${cat.commands.length}</span>
                </div>
            `).join('');
        }

        // Ê∏≤ÊüìÊåá‰ª§ÂÜÖÂÆπ
        function renderCommandContent(categoryId) {
            const category = categories.find(cat => cat.id === categoryId);
            if (!category) return;

            const container = document.getElementById('commandContent');
            container.innerHTML = `
                <h2 style="margin-bottom: 20px; color: #5a67d8; display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5em;">${category.icon}</span>
                    ${category.title}
                </h2>
                ${category.commands.map((cmd, index) => `
                    <div class="command-item">
                        <div class="command-english">${cmd.english}</div>
                        <div class="command-chinese">${cmd.chinese}</div>
                        <div class="audio-controls">
                            <button class="audio-btn" onclick="playAudio('${category.id}-${index}', '${encodeURIComponent(cmd.english)}')">
                                üîä
                            </button>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        // ÈÄâÊã©ÂàÜÁ±ª
        function selectCategory(catId) {
            // Êõ¥Êñ∞Ê†áÁ≠æÁä∂ÊÄÅ
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`tab-${catId}`).classList.add('active');

            // Ê∏≤ÊüìÂØπÂ∫îÁöÑÂÜÖÂÆπ
            renderCommandContent(catId);

            currentCategory = catId;
        }

        // Êí≠ÊîæÈü≥È¢ë
        function playAudio(id, text) {
            const btn = event.target;
            
            // Â¶ÇÊûúÊ≠£Âú®Êí≠ÊîæÔºåÂÖàÂÅúÊ≠¢
            if (btn.classList.contains('playing')) {
                speechSynthesis.cancel();
                btn.classList.remove('playing');
                return;
            }
            
            btn.classList.add('playing');
            const decodedText = decodeURIComponent(text);
            
            const utterance = new SpeechSynthesisUtterance(decodedText);
            
            // Ëé∑ÂèñÊâÄÊúâÂèØÁî®ËØ≠Èü≥Âπ∂ÈÄâÊã©ÊúÄ‰ºòË¥®ÁöÑ
            const voices = speechSynthesis.getVoices();
            
            // ‰ºòÂÖàÁ∫ßÊéíÂ∫èÔºöÂØªÊâæÊúÄ‰ºòË¥®ÁöÑËã±ËØ≠ËØ≠Èü≥
            const voicePriority = [
                // ÊúÄÈ´ò‰ºòÂÖàÁ∫ßÔºöGoogle ÁöÑËã±ËØ≠ËØ≠Èü≥
                voice => voice.name.includes('Google') && voice.lang.includes('en'),
                // Ê¨°‰ºòÂÖàÁ∫ßÔºöMicrosoft ÁöÑËã±ËØ≠ËØ≠Èü≥
                voice => voice.name.includes('Microsoft') && voice.lang.includes('en'),
                // Á¨¨‰∏â‰ºòÂÖàÁ∫ßÔºöÊ†áËÆ∞‰∏∫ Premium Êàñ Natural ÁöÑËã±ËØ≠ËØ≠Èü≥
                voice => (voice.name.includes('Premium') || voice.name.includes('Natural')) && voice.lang.includes('en'),
                // Á¨¨Âõõ‰ºòÂÖàÁ∫ßÔºöËã±ÂõΩÊàñÁà±Â∞îÂÖ∞Ëã±ËØ≠
                voice => voice.lang === 'en-GB' || voice.lang === 'en-IE',
                // Á¨¨‰∫î‰ºòÂÖàÁ∫ßÔºö‰ªª‰ΩïËã±ËØ≠ËØ≠Èü≥
                voice => voice.lang.startsWith('en')
            ];
            
            let selectedVoice = null;
            for (const criterion of voicePriority) {
                const matchingVoices = voices.filter(criterion);
                if (matchingVoices.length > 0) {
                    selectedVoice = matchingVoices[0];
                    break;
                }
            }
            
            if (selectedVoice) {
                utterance.voice = selectedVoice;
                console.log('‰ΩøÁî®ËØ≠Èü≥:', selectedVoice.name);
            }
            
            utterance.rate = speechRate;
            utterance.pitch = 1;
            utterance.volume = 1;
            
            utterance.onend = () => {
                btn.classList.remove('playing');
            };
            
            utterance.onerror = (event) => {
                console.error('ËØ≠Èü≥Êí≠ÊîæÈîôËØØ:', event);
                btn.classList.remove('playing');
            };
            
            speechSynthesis.speak(utterance);
        }

        // ÂÅúÊ≠¢ÊâÄÊúâÈü≥È¢ë
        function stopAllAudio() {
            speechSynthesis.cancel();
            const playingButtons = document.querySelectorAll('.audio-btn.playing');
            playingButtons.forEach(btn => btn.classList.remove('playing'));
        }

        // Êõ¥Êñ∞ËØ≠ÈÄü
        function updateSpeechRate() {
            speechRate = parseFloat(document.getElementById('speechRate').value);
        }

        // ÂàáÊç¢Ê®°Âºè
        function showMode(mode) {
            currentMode = mode;
            
            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ÊòæÁ§∫ÂØπÂ∫îÂÜÖÂÆπ
            document.getElementById('learn-mode').style.display = 'none';
            document.getElementById('quiz-mode').style.display = 'none';
            
            if (mode === 'learn') {
                document.getElementById('learn-mode').style.display = 'block';
            } else if (mode.startsWith('quiz')) {
                document.getElementById('quiz-mode').style.display = 'block';
                quizMode = mode;
                startQuiz();
            }
        }

        // ÂºÄÂßãÊµãÈ™å
        function startQuiz() {
            // Êî∂ÈõÜÊâÄÊúâÂëΩ‰ª§
            quizQuestions = [];
            
            if (quizMode === 'quiz-cn-en') {
                // ‰∏≠ËØëËã±ÔºöÈúÄË¶ÅÂéªÈáç‰∏≠Êñá
                const uniqueChinese = new Map();
                categories.forEach(cat => {
                    cat.commands.forEach(cmd => {
                        if (!uniqueChinese.has(cmd.chinese)) {
                            uniqueChinese.set(cmd.chinese, {
                                english: cmd.english,
                                chinese: cmd.chinese,
                                category: cat.title
                            });
                        }
                    });
                });
                quizQuestions = Array.from(uniqueChinese.values());
            } else {
                // Ëã±ËØë‰∏≠Ôºö‰øùÁïôÊâÄÊúâ‰∏çÂêåÁöÑËã±ÊñáÂè•Â≠ê
                categories.forEach(cat => {
                    cat.commands.forEach(cmd => {
                        quizQuestions.push({
                            english: cmd.english,
                            chinese: cmd.chinese,
                            category: cat.title
                        });
                    });
                });
            }
            
            // ÈöèÊú∫Êâì‰π±
            quizQuestions.sort(() => Math.random() - 0.5);
            
            // ÈáçÁΩÆÁä∂ÊÄÅ
            currentQuestionIndex = 0;
            score = 0;
            totalQuestions = 0;
            
            // ÊòæÁ§∫Á¨¨‰∏ÄÈ¢ò
            showQuestion();
        }

        // ÊòæÁ§∫È¢òÁõÆ
        function showQuestion() {
            if (currentQuestionIndex >= quizQuestions.length) {
                // ÊµãÈ™åÁªìÊùü
                showQuizResult();
                return;
            }
            
            const question = quizQuestions[currentQuestionIndex];
            const isChineseToEnglish = quizMode === 'quiz-cn-en';
            
            // ÊòæÁ§∫È¢òÁõÆ
            document.getElementById('quizQuestion').innerHTML = 
                isChineseToEnglish ? 
                `<strong>ËØ∑ÈÄâÊã©Ê≠£Á°ÆÁöÑËã±ÊñáÁøªËØë:</strong><br>${question.chinese}` :
                `<strong>ËØ∑ÈÄâÊã©Ê≠£Á°ÆÁöÑ‰∏≠ÊñáÁøªËØë:</strong><br>${question.english}`;
            
            // ÁîüÊàêÈÄâÈ°π
            let options = [];
            
            if (isChineseToEnglish) {
                // ‰∏≠ËØëËã±ÔºöÊâæÂá∫ÊâÄÊúâËØ•‰∏≠ÊñáÂØπÂ∫îÁöÑËã±Êñá
                const correctAnswers = quizQuestions
                    .filter(q => q.chinese === question.chinese)
                    .map(q => q.english);
                
                // Ê∑ªÂä†ÊâÄÊúâÊ≠£Á°ÆÁ≠îÊ°à
                options.push(...correctAnswers);
                
                // Ê∑ªÂä†ÂÖ∂‰ªñÈîôËØØÈÄâÈ°πÔºåÁ°Æ‰øù‰∏çÈáçÂ§ç
                const wrongOptions = quizQuestions
                    .filter(q => q.chinese !== question.chinese)
                    .map(q => q.english)
                    .filter(eng => !options.includes(eng))
                    .sort(() => Math.random() - 0.5);
                
                // Ë°•ÂÖÖÂà∞4‰∏™ÈÄâÈ°π
                while (options.length < 4 && wrongOptions.length > 0) {
                    options.push(wrongOptions.shift());
                }
            } else {
                // Ëã±ËØë‰∏≠ÔºöÁ°Æ‰øùÂåÖÂê´Ê≠£Á°ÆÁ≠îÊ°à
                const correctAnswer = question.chinese;
                options.push(correctAnswer);
                
                // Êü•ÊâæÊâÄÊúâÂèØËÉΩÁöÑÂêå‰πâÁ≠îÊ°à
                const allCorrectAnswers = categories
                    .flatMap(cat => cat.commands)
                    .filter(cmd => cmd.english === question.english)
                    .map(cmd => cmd.chinese);
                
                // Ê∑ªÂä†ÂÖ∂‰ªñÂêå‰πâÁ≠îÊ°àÔºàÂ¶ÇÊûúÊúâÔºâ
                allCorrectAnswers.forEach(answer => {
                    if (!options.includes(answer)) {
                        options.push(answer);
                    }
                });
                
                // Ê∑ªÂä†ÈîôËØØÈÄâÈ°π
                const wrongOptions = categories
                    .flatMap(cat => cat.commands)
                    .filter(cmd => cmd.english !== question.english)
                    .map(cmd => cmd.chinese)
                    .filter(chi => !options.includes(chi))
                    .sort(() => Math.random() - 0.5);
                
                // Ë°•ÂÖÖÂà∞4‰∏™ÈÄâÈ°π
                while (options.length < 4 && wrongOptions.length > 0) {
                    const wrongOption = wrongOptions.shift();
                    if (!options.includes(wrongOption)) {
                        options.push(wrongOption);
                    }
                }
            }
            
            // Êâì‰π±ÈÄâÈ°πÈ°∫Â∫è
            options.sort(() => Math.random() - 0.5);
            
            // Ëé∑ÂèñÁ¨¨‰∏Ä‰∏™Ê≠£Á°ÆÁ≠îÊ°àÔºàÁî®‰∫éÂÖºÂÆπÔºâ
            const firstCorrectAnswer = isChineseToEnglish ? 
                quizQuestions.find(q => q.chinese === question.chinese).english :
                question.chinese;
            
            // Ê∏≤ÊüìÈÄâÈ°π
            document.getElementById('quizOptions').innerHTML = options.map((opt, index) => `
                <div class="quiz-option" data-index="${index}">
                    ${opt}
                </div>
            `).join('');
            
            // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂ÁõëÂê¨Âô®
            document.querySelectorAll('.quiz-option').forEach((optElement, idx) => {
                optElement.onclick = () => checkAnswer(idx, firstCorrectAnswer);
            });
            
            // Â¶ÇÊûúÊòØËã±ËØë‰∏≠ÔºåÊí≠ÊîæÈü≥È¢ë
            if (!isChineseToEnglish) {
                // ÂÖàÂÅúÊ≠¢‰ªª‰ΩïÊ≠£Âú®Êí≠ÊîæÁöÑÈü≥È¢ë
                speechSynthesis.cancel();
                
                setTimeout(() => {
                    const utterance = new SpeechSynthesisUtterance(question.english);
                    const voices = speechSynthesis.getVoices();
                    const englishVoices = voices.filter(v => v.lang.includes('en'));
                    if (englishVoices.length > 0) {
                        utterance.voice = englishVoices[0];
                    }
                    utterance.rate = speechRate;
                    speechSynthesis.speak(utterance);
                }, 500);
            }
        }

        // Ê£ÄÊü•Á≠îÊ°à
        function checkAnswer(index, correctAnswer) {
            const options = document.querySelectorAll('.quiz-option');
            const selectedOption = options[index];
            const selectedText = selectedOption.textContent.trim();
            
            totalQuestions++;
            
            // Ëé∑ÂèñÂΩìÂâçÈ¢òÁõÆ
            const currentQuestion = quizQuestions[currentQuestionIndex];
            const isChineseToEnglish = quizMode === 'quiz-cn-en';
            
            let isCorrect = false;
            let allCorrectAnswers = [];
            
            if (isChineseToEnglish) {
                // ‰∏≠ËØëËã±ÔºöÊü•ÊâæÊâÄÊúâÂÖ∑ÊúâÁõ∏Âêå‰∏≠ÊñáÁöÑÁ≠îÊ°à
                allCorrectAnswers = quizQuestions
                    .filter(q => q.chinese === currentQuestion.chinese)
                    .map(q => q.english);
                
                isCorrect = allCorrectAnswers.includes(selectedText);
                
                // Ê†áËÆ∞ÊâÄÊúâÊ≠£Á°ÆÁ≠îÊ°à
                options.forEach(opt => {
                    const optText = opt.textContent.trim();
                    if (allCorrectAnswers.includes(optText)) {
                        opt.classList.add('correct');
                    } else if (opt === selectedOption && !isCorrect) {
                        opt.classList.add('incorrect');
                    }
                });
            } else {
                // Ëã±ËØë‰∏≠ÔºöÊü•ÊâæÊâÄÊúâÂÖ∑ÊúâÁõ∏ÂêåËã±ÊñáÁöÑÁ≠îÊ°à
                allCorrectAnswers = quizQuestions
                    .filter(q => q.english === currentQuestion.english)
                    .map(q => q.chinese);
                
                isCorrect = allCorrectAnswers.includes(selectedText);
                
                // Ê†áËÆ∞ÊâÄÊúâÊ≠£Á°ÆÁ≠îÊ°à
                options.forEach(opt => {
                    const optText = opt.textContent.trim();
                    if (allCorrectAnswers.includes(optText)) {
                        opt.classList.add('correct');
                    } else if (opt === selectedOption && !isCorrect) {
                        opt.classList.add('incorrect');
                    }
                });
            }
            
            if (isCorrect) {
                score++;
            } else {
                // ËÆ∞ÂΩïÈîôÈ¢ò
                wrongAnswers.push({
                    question: currentQuestion,
                    userAnswer: selectedText,
                    correctAnswers: allCorrectAnswers,
                    mode: quizMode
                });
            }
            
            // Á¶ÅÁî®ÊâÄÊúâÈÄâÈ°π
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            // Êõ¥Êñ∞ÂàÜÊï∞
            document.getElementById('quizScore').textContent = `ÂæóÂàÜ: ${score} / ${totalQuestions}`;
            
            // Ê†πÊçÆÁ≠îÈ¢òÁªìÊûúÂÜ≥ÂÆöË∑≥ËΩ¨Êó∂Èó¥
            const delay = isCorrect ? 200 : 2000;  // Ê≠£Á°Æ200msÔºåÈîôËØØ2Áßí
            setTimeout(() => {
                nextQuestion();
            }, delay);
        }

        // ‰∏ã‰∏ÄÈ¢ò
        function nextQuestion() {
            // ÂÅúÊ≠¢ÂΩìÂâçÈü≥È¢ë
            speechSynthesis.cancel();
            currentQuestionIndex++;
            showQuestion();
        }

        // ÈáçÁΩÆÊµãÈ™å
        function resetQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            totalQuestions = 0;
            wrongAnswers = [];  // Ê∏ÖÁ©∫ÈîôÈ¢òËÆ∞ÂΩï
            document.getElementById('quizScore').textContent = 'ÂæóÂàÜ: 0 / 0';
            startQuiz();
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>